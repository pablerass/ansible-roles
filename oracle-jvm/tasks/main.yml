---
# tasks file for oracle-jvm
- name: "Add webupd8 Apt key"
  apt_key:
        id={{ webupd8_apt_key }}
        keyserver=keyserver.ubuntu.com

- name: "Add the webupd8 APT repository"
  apt_repository:
        repo={{ webupd8_ppa }}
  register: webupd8_ppa

- name: "Auto accept Oracle license"
  command:
        sh -c 'echo debconf shared/accepted-oracle-license-v1-1 select true | debconf-set-selections'
  changed_when: false

- name: "Install Oracle JVM packages"
  apt:  name=oracle-java{{ item }}-installer
  with_items: '{{ oracle_jvm_versions }}'

# TODO: Fix this to make it work
#- name: "Check Oracle JVM default version"
#  fail: "Version {{ oracle_jvm_default_version }} not in {{ oracle_jvm_versions }}"
#  when: oracle_jvm_default_version is defined and
#        oracle_java_default_version not in oracle_jvm_versions

- name: "Set Oracle JVM as default"
  apt:  name=oracle-java{{ oracle_jvm_default_version }}-set-default
  when: oracle_jvm_default_version is defined
